{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/ec2-xrdp-teamviewer","result":{"data":{"markdownRemark":{"id":"d9fe619b-1f8d-5805-8215-4490baf85ee8","html":"<h1 id=\"motivation\" style=\"position:relative;\"><a href=\"#motivation\" aria-label=\"motivation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Motivation</h1>\n<p>I wanted to setup an easy GUI way for my colleagues to access our EC2 Ubuntu instances and run openquake compute jobs without having to go through the hassle of learning about ssh, rsync, scp and all the other simple bash commands I take for granted. That necessitated some sort of remote desktop solution, and I considered xrdp and Teamviewer. </p>\n<h1 id=\"which-one-is-better\" style=\"position:relative;\"><a href=\"#which-one-is-better\" aria-label=\"which one is better permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Which one is better?</h1>\n<p>For usage in small teams such as mine, it would have to be Teamviewer, hands down. Teamviewer had lower latency, better video quality, and way better file transfer speeds. That last point was especially important, since we generated large datasets which we needed to transfer back to your local PCs for extensive post-processing. </p>\n<p>Considering an c5.24xlarge instance and a gigabit fibre connection (1Gbps down/ 1Gbps up) on my end, I was getting at most 1MB/s. With Teamviewer, I was able to get close to rsync speeds, at about 5-10 MB/s. Also, obviously, the remote ID doesn’t change every time you stop and start an instance, which makes things a lot easier when explaining the setup to your non-IT minded teammates. </p>\n<h1 id=\"teamviewer-installation-and-initialization\" style=\"position:relative;\"><a href=\"#teamviewer-installation-and-initialization\" aria-label=\"teamviewer installation and initialization permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Teamviewer installation and initialization</h1>\n<p>Of course, the flipside is that Teamviewer is a little more tedious to setup, especially since an EC2 instance is headless. After some intense googling, I found <a href=\"https://thilinamad.medium.com/remote-desktop-to-ubuntu-instance-with-no-gui-f98566adb53e\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">this guide by Thilina Madumal</a> that was just what was required. If some of the steps below don’t make sense, read through the guide! </p>\n<p>I opted to install vanilla lxde instead as my default desktop environment because it was lightweight. Since I had to do this for several instances, I wrote a script that installs and configures (almost) everything starting from a fresh instance. </p>\n<ol>\n<li>\n<p><strong>Create the xorg.conf file</strong></p>\n<p>ssh into your instance and then navigate to your home directory with <code class=\"language-text\">cd ~</code> and create a file called <code class=\"language-text\">xorg.conf</code> with the following contents: </p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># This xorg configuration file is meant to be used</span>\n<span class=\"token comment\"># to start a dummy X11 server.</span>\n<span class=\"token comment\"># For details, please see:</span>\n<span class=\"token comment\"># https://www.xpra.org/xorg.conf</span>\n \n<span class=\"token comment\"># Here we setup a Virtual Display of 1600x900 pixels</span>\n \nSection <span class=\"token string\">\"Device\"</span>\n\t\tIdentifier  <span class=\"token string\">\"Configured Video Device\"</span>\n\t\tDriver      <span class=\"token string\">\"dummy\"</span>\n\t\t<span class=\"token comment\">#VideoRam 4096000</span>\n\t\t<span class=\"token comment\">#VideoRam 256000</span>\n\t\tVideoRam    <span class=\"token number\">16384</span>\nEndSection\n \nSection <span class=\"token string\">\"Monitor\"</span>\n\t\tIdentifier  <span class=\"token string\">\"Configured Monitor\"</span>\n\t\tHorizSync   <span class=\"token number\">5.0</span> - <span class=\"token number\">1000.0</span>\n\t\tVertRefresh <span class=\"token number\">5.0</span> - <span class=\"token number\">200.0</span>\n\t\tModeline <span class=\"token string\">\"1600x900\"</span> <span class=\"token number\">33.92</span> <span class=\"token number\">1600</span> <span class=\"token number\">1632</span> <span class=\"token number\">1760</span> <span class=\"token number\">1792</span> <span class=\"token number\">900</span> <span class=\"token number\">921</span> <span class=\"token number\">924</span> <span class=\"token number\">946</span>\nEndSection\n \nSection <span class=\"token string\">\"Screen\"</span>\n\t\tIdentifier  <span class=\"token string\">\"Default Screen\"</span>\n\t\tMonitor     <span class=\"token string\">\"Configured Monitor\"</span>\n\t\tDevice      <span class=\"token string\">\"Configured Video Device\"</span>\n\t\tDefaultDepth <span class=\"token number\">24</span>\n\t\tSubSection <span class=\"token string\">\"Display\"</span>\n\t\t\t\t Viewport <span class=\"token number\">0</span> <span class=\"token number\">0</span>\n\t\t\t\t Depth <span class=\"token number\">24</span>\n\t\t\t\t Virtual <span class=\"token number\">1920</span> <span class=\"token number\">1080</span>\n\t\tEndSubSection\nEndSection</code></pre></div>\n<p>Note the resolution numbers for the “Display” SubSection. You can change this to whichever suites your needs. I chose standard HD. </p>\n</li>\n<li>\n<p><strong>Create the install script</strong></p>\n<p>In the same directory, create a file called <code class=\"language-text\">setup.sh</code> with the following contents: </p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/sh</span>\n\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> update -y\n<span class=\"token function\">yes</span> Y <span class=\"token operator\">|</span> <span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> lxde\n<span class=\"token function\">wget</span> https://download.teamviewer.com/download/linux/teamviewer_amd64.deb\n<span class=\"token function\">yes</span> Y <span class=\"token operator\">|</span> <span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> ./teamviewer_amd64.deb\n<span class=\"token function\">sudo</span> teamviewer <span class=\"token function\">passwd</span> <span class=\"token operator\">&lt;</span>your password here<span class=\"token operator\">></span>\n<span class=\"token function\">sudo</span> teamviewer daemon <span class=\"token builtin class-name\">enable</span>\n<span class=\"token function\">sudo</span> teamviewer license accept\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> update -y\n<span class=\"token function\">yes</span> Y <span class=\"token operator\">|</span> <span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> xserver-xorg-video-dummy\n<span class=\"token function\">sudo</span> <span class=\"token function\">cp</span> xorg.conf /etc/X11/</code></pre></div>\n<p>Replace &#x3C;your password here> with the remote access password of your choice.</p>\n</li>\n<li>\n<p><strong>Set your instance password</strong></p>\n<p>The user password for the instance has to be set with <code class=\"language-text\">sudo passwd ubuntu</code>. </p>\n</li>\n<li>\n<p><strong>Check your teamviewer ID and reboot</strong></p>\n<p>Type <code class=\"language-text\">teamviewer info</code> to see the teamviewer ID for this instance then reboot with <code class=\"language-text\">sudo reboot</code>.  </p>\n</li>\n</ol>\n<p>After the instance has rebooted, you should be able to connect to the instance via Teamviewer. On the login screen, enter the password you set for <code class=\"language-text\">ubuntu</code>.Once I was in, I disabled the login screen since access control is already performed with the Teamviewer remote access password, and I didn’t want my team to have to remember 2 passwords anyway. </p>\n<p>To see how I setup an EC2 monitoring script that sent notifications to my iPhone, click <a href=\"/posts/ec2-ios-monitoring\">here</a>.</p>","fields":{"slug":"/posts/ec2-xrdp-teamviewer","tagSlugs":["/tag/ec-2/","/tag/xrdp/","/tag/teamviewer/"]},"frontmatter":{"date":"2021-05-15T19:11:04.535Z","description":"Comparing xrdp and TeamViewer on EC2 Ubuntu instances","tags":["EC2","xrdp","teamviewer"],"title":"EC2-Ubuntu -  xrdp or TeamViewer","socialImage":null}}},"pageContext":{"slug":"/posts/ec2-xrdp-teamviewer"}},"staticQueryHashes":["251939775","401334301","825871152"]}